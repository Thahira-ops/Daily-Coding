<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Applicant Form</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
  :root {
    --brand-primary: #5e4ae3;
    --brand-secondary: #ff6b6b;
    --brand-accent: #ff9f43;
    --text-color: #333;
    --light-bg: #f8f9fa;
  }

  body {
    background: linear-gradient(135deg, #5e4ae3, #ff6b6b, #ff9f43);
    background-size: 600% 600%;
    animation: rainbowBg 10s ease infinite;
    font-family: "Segoe UI", sans-serif;
    min-height: 100vh;
    margin: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
  }

  @keyframes rainbowBg {
    0% {
      background-position: 0% 50%;
    }
    50% {
      background-position: 100% 50%;
    }
    100% {
      background-position: 0% 50%;
    }
  }

  .container {
    background: #ffffff;
    padding: 40px 30px;
    border-radius: 20px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
    max-width: 960px;
    width: 100%;
  }

  header h2 {
    color: var(--brand-secondary);
    font-weight: bold;
    font-size: 24px;
  }

  h3.text-gradient {
    font-size: 26px;
    margin-bottom: 25px;
    text-align: center;
    background: linear-gradient(to right, var(--brand-primary), var(--brand-accent));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    font-weight: bold;
  }

  .form-label {
    color: var(--brand-primary);
    font-weight: 600;
  }

  .form-control,
  .form-select {
    border-radius: 8px;
    padding: 10px 12px;
  }

  .form-control:focus,
  .form-select:focus {
    border-color: var(--brand-secondary);
    box-shadow: 0 0 0 0.2rem rgba(255, 107, 107, 0.25);
  }

  .btn-primary {
    background: linear-gradient(to right, var(--brand-primary), var(--brand-accent));
    border: none;
    padding: 12px 30px;
    border-radius: 25px;
    font-weight: 600;
    font-size: 16px;
    transition: transform 0.3s ease;
  }

  .btn-primary:hover {
    background: linear-gradient(to right, var(--brand-secondary), var(--brand-accent));
    transform: scale(1.05);
  }

  .hidden {
    display: none !important;
  }

  .add-row-btn {
    cursor: pointer;
    font-size: 1.2rem;
    color: var(--brand-primary);
  }

  .add-row-btn:hover {
    color: var(--brand-secondary);
  }

  #statusMessage {
    font-size: 16px;
  }

  table th,
  table td {
    vertical-align: middle !important;
  }

  @media (max-width: 768px) {
    .form-label {
      font-size: 14px;
    }

    .btn-primary {
      font-size: 14px;
      padding: 10px 20px;
    }

    header h2 {
      font-size: 20px;
    }

    h3.text-gradient {
      font-size: 22px;
    }
  }
</style>

</head>

<body>
  <div class="container">
    <header style="text-align: center; margin-bottom: 30px;">
      <h2 style="color: #e3799e; font-weight: bold;">P&C PROJECTS PRIVATE LIMITED</h2>
    </header>
    <h3 class="text-center mb-4 text-gradient">APPLICANT FORM</h3>

    <form id="jobForm" class="row g-3">
      <!-- Standard Fields -->
      <div class="col-md-6">
        <label for="name" class="form-label">Your Name *</label>
        <input type="text" class="form-control" id="name" required />
      </div>
      <div class="col-md-6">
        <label for="email" class="form-label">Your Email *</label>
        <input type="email" class="form-control" id="email" required />
      </div>

      <div class="col-md-6">
        <label for="gender" class="form-label">Gender *</label>
        <select id="gender" class="form-select" required>
          <option value="">Select</option>
          <option value="Male">Male</option>
          <option value="Female">Female</option>
          <option value="Other">Other</option>
        </select>
      </div>

      <div class="col-md-6">
        <label for="blood" class="form-label">Blood Group *</label>
        <select id="blood" class="form-select" required>
          <option value="O+">O+</option>
          <option value="A+">A+</option>
          <option value="A-">A-</option>
          <option value="B+">B+</option>
          <option value="B-">B-</option>
          <option value="O-">O-</option>
          <option value="AB+">AB+</option>
          <option value="AB-">AB-</option>
        </select>
      </div>
      <div class="col-md-6">
        <label for="mobile" class="form-label">Mobile Number *</label>
        <input type="tel" class="form-control" id="mobile" required />
      </div>
      <div class="col-md-6">
        <label for="emergency" class="form-label">Emergency Contact *</label>
        <input type="tel" class="form-control" id="emergency" required />
      </div>
      <div class="col-md-6">
        <label for="dobYear" class="form-label">Year of Birth *</label>
        <input type="number" class="form-control" id="dobYear" required />
      </div>
      <div class="col-md-6">
        <label for="age" class="form-label">Age</label>
        <input type="text" class="form-control" id="age" readonly />
      </div>
      <div class="col-md-6">
        <label for="appliedDate" class="form-label">Applied Date *</label>
        <input type="date" class="form-control" id="appliedDate" required />
      </div>
      <div class="col-md-6">
        <label for="marital" class="form-label">Marital Status *</label>
        <select id="marital" class="form-select" required>
          <option value="">Select</option>
          <option value="Single">Single</option>
          <option value="Married">Married</option>
        </select>
      </div>
      <div class="col-md-6 hidden" id="marriageYearGroup">
        <label for="marriageYear" class="form-label">Marriage Year *</label>
        <input type="number" class="form-control" id="marriageYear" />
      </div>
      <div class="col-md-6">
  <label for="education" class="form-label">Highest Education Qualification *</label>
  <select id="education" class="form-select" required>
    <option value="">Select</option>
    <option value="SSLC">SSLC</option>
    <option value="HSC">HSC</option>
    <option value="UG">UG</option>
    <option value="PG">PG</option>
    <option value="Others">Others</option>
  </select>
</div>

<!-- Input field only shown if "Others" is selected -->
<div class="col-md-6 hidden" id="otherEducationGroup">
  <label for="otherEducation" class="form-label">Specify Education *</label>
  <input type="text" class="form-control" id="otherEducation" />
</div>
<!-- Experience -->
      <div class="col-md-6">
        <label for="experience" class="form-label">Are you Fresher/Experienced *</label>
        <select id="experience" class="form-select" required>
          <option value="">Select</option>
          <option value="Fresher">Fresher</option>
          <option value="Experienced">Experienced</option>
        </select>
      </div>

      <!-- Experience table -->
      <div class="col-12 hidden" id="experienceTableContainer">
        <label class="form-label">Experience Details</label>
        <div class="table-responsive">
          <table class="table table-bordered table-sm align-middle text-center" id="experienceTable">
            <thead class="table-light">
              <tr>
                <th>Designation</th>
                <th>Roles & Responsibilities</th>
                <th>Years of Experience</th>
                <th><span class="add-row-btn" id="addRowBtn" title="Add Row">➕</span></th>
              </tr>
            </thead>
            <tbody id="experienceTbody">
              <tr>
                <td><input type="text" class="form-control" name="designation[]"></td>
                <td><input type="text" class="form-control" name="responsibilities[]"></td>
               <td><input type="number" step="any" class="form-control yearInput" name="years[]"></td>
                <td></td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="mt-2 text-end">
          <label><strong>Total Years of Experience:</strong></label>
          <input type="text" class="form-control d-inline-block w-auto" id="totalExperience" readonly />
        </div>
      </div> 

      <div class="col-md-6">
        <label class="form-label">Languages You Speak *</label><br />
        <div id="languageSpeakGroup">
          <div><input type="checkbox" name="languageSpeak" value="English" /> English</div>
          <div><input type="checkbox" name="languageSpeak" value="Tamil" /> Tamil</div>
          <div><input type="checkbox" name="languageSpeak" value="Hindi" /> Hindi</div>
          <div><input type="checkbox" name="languageSpeak" value="Others" id="langSpeakOthersChk" /> Others</div>
        </div>
      </div>
      <div class="col-md-6 hidden" id="otherSpeakGroup">
        <label for="otherSpeak" class="form-label">Other Spoken Language</label>
        <input type="text" class="form-control" id="otherSpeak" />
      </div>

      <!-- ✅ Language Write (checkboxes) -->
      <div class="col-md-6">
        <label class="form-label">Languages You Write *</label><br />
        <div id="languageWriteGroup">
          <div><input type="checkbox" name="languageWrite" value="English" /> English</div>
          <div><input type="checkbox" name="languageWrite" value="Tamil" /> Tamil</div>
          <div><input type="checkbox" name="languageWrite" value="Hindi" /> Hindi</div>
          <div><input type="checkbox" name="languageWrite" value="Others" id="langWriteOthersChk" /> Others</div>
        </div>
      </div>
      <div class="col-md-6 hidden" id="otherWriteGroup">
        <label for="otherWrite" class="form-label">Other Written Language</label>
        <input type="text" class="form-control" id="otherWrite" />
      </div>
      <!-- More personal fields -->
      <!-- Gender, DOB, Mobile, etc. already in your current form -->
      <!-- Continue adding as per your original code -->

      
      <div class="col-12">
        <label for="knowCompany" class="form-label">How do you know this company? *</label>
        <input type="text" class="form-control" id="knowCompany" required />
      </div>

      <!-- Resume Upload -->
      <div class="col-12">
        <label for="resume" class="form-label">Resume *</label>
        <input type="file" class="form-control" id="resume" required />
      </div>

      <!-- Submit -->
      <div class="col-12 text-center">
        <button type="submit" class="btn btn-primary mt-3">Submit</button>
        <div id="statusMessage" class="mt-3 fw-bold"></div>
      </div>
    </form>
    <div id="successBanner" class="alert alert-success text-center d-none" role="alert">
  ✅ Application submitted successfully!
</div>

  </div>
<script>
  const form = document.getElementById("jobForm");
  const status = document.getElementById("statusMessage");

  const dobYear = document.getElementById("dobYear");
  const ageField = document.getElementById("age");

  const marital = document.getElementById("marital");
  const marriageYearGroup = document.getElementById("marriageYearGroup");
  const marriageYear = document.getElementById("marriageYear");

  const education = document.getElementById("education");
  const otherEducationGroup = document.getElementById("otherEducationGroup");
  const otherEducation = document.getElementById("otherEducation");

  const experience = document.getElementById("experience");
  const experienceTableContainer = document.getElementById("experienceTableContainer");
  const experienceTbody = document.getElementById("experienceTbody");
  const addRowBtn = document.getElementById("addRowBtn");
  const totalExperience = document.getElementById("totalExperience");

  const langSpeakOthersChk = document.getElementById("langSpeakOthersChk");
  const langWriteOthersChk = document.getElementById("langWriteOthersChk");
  const otherSpeakGroup = document.getElementById("otherSpeakGroup");
  const otherWriteGroup = document.getElementById("otherWriteGroup");
  const otherSpeak = document.getElementById("otherSpeak");
  const otherWrite = document.getElementById("otherWrite");

  // ✅ Auto-calculate Age
  dobYear.addEventListener("input", () => {
    const currentYear = new Date().getFullYear();
    const year = parseInt(dobYear.value);
    ageField.value = !isNaN(year) ? currentYear - year : "";
  });

  // ✅ Set today's date on load
  window.addEventListener("DOMContentLoaded", () => {
    const today = new Date().toISOString().split("T")[0];
    document.getElementById("appliedDate").value = today;
  });

  // ✅ Marital status toggle
  marital.addEventListener("change", () => {
    marriageYearGroup.classList.toggle("hidden", marital.value !== "Married");
    if (marital.value !== "Married") {
      marriageYear.value = "";
    }
  });

  // ✅ Education field toggle
  education.addEventListener("change", () => {
    if (education.value === "Others") {
      otherEducationGroup.classList.remove("hidden");
      otherEducation.setAttribute("required", "required");
    } else {
      otherEducationGroup.classList.add("hidden");
      otherEducation.removeAttribute("required");
      otherEducation.value = "";
    }
  });

  // ✅ Experience field toggle
  experience.addEventListener("change", () => {
    experienceTableContainer.classList.toggle("hidden", experience.value !== "Experienced");
  });

  // ✅ Add row in experience table
  addRowBtn.addEventListener("click", () => {
    const row = document.createElement("tr");
    row.innerHTML = `
      <td><input type="text" class="form-control" name="designation[]"></td>
      <td><input type="text" class="form-control" name="responsibilities[]"></td>
      <td><input type="number" class="form-control yearInput" name="years[]"></td>
      <td></td>
    `;
    experienceTbody.appendChild(row);
  });

  // ✅ Calculate total experience
  experienceTbody.addEventListener("input", () => {
    const yearInputs = document.querySelectorAll(".yearInput");
    let total = 0;
    yearInputs.forEach(input => {
      const val = parseFloat(input.value);
      if (!isNaN(val)) total += val;
    });
    totalExperience.value = total.toFixed(1);
  });

  // ✅ Language "Others" input toggle
  langSpeakOthersChk.addEventListener("change", () => {
    otherSpeakGroup.classList.toggle("hidden", !langSpeakOthersChk.checked);
    if (!langSpeakOthersChk.checked) otherSpeak.value = "";
  });

  langWriteOthersChk.addEventListener("change", () => {
    otherWriteGroup.classList.toggle("hidden", !langWriteOthersChk.checked);
    if (!langWriteOthersChk.checked) otherWrite.value = "";
  });

  // ✅ Helper to get checked checkbox values
  function getCheckedValues(name) {
    return Array.from(document.querySelectorAll(`input[name="${name}"]:checked`)).map(el => el.value);
  }

  // ✅ Submit handler
  form.addEventListener("submit", async (e) => {
    e.preventDefault();
    status.textContent = "⏳ Uploading...";
    status.style.color = "#444";

    const resumeFile = document.getElementById("resume").files[0];
    if (!resumeFile) {
      status.textContent = "❌ Resume file is required.";
      status.style.color = "red";
      return;
    }

    const reader = new FileReader();
    reader.onload = async () => {
      const base64Data = reader.result.split(",")[1];

      const expRows = Array.from(experienceTbody.querySelectorAll("tr"));
      const experienceDetails = expRows.map(row => {
        const designation = row.querySelector('input[name="designation[]"]')?.value || "";
        const roles = row.querySelector('input[name="responsibilities[]"]')?.value || "";
        const years = row.querySelector('input[name="years[]"]')?.value || "";
        return { designation, roles, years };
      });

      const data = {
        name: document.getElementById("name").value,
        email: document.getElementById("email").value,
        gender: document.getElementById("gender").value,
        blood: document.getElementById("blood").value,
        mobile: document.getElementById("mobile").value,
        emergency: document.getElementById("emergency").value,
        dobYear: dobYear.value,
        age: ageField.value,
        appliedDate: document.getElementById("appliedDate").value,
        maritalStatus: marital.value,
        marriageYear: marriageYear.value,
        education: education.value,
        otherEducation: otherEducation.value,
        experience: experience.value,
        experienceDetails,
        experienceYears: totalExperience.value,
        preferredRole: document.getElementById("preferredRole")?.value || "",
        languageSpeak: getCheckedValues("languageSpeak"),
        languageWrite: getCheckedValues("languageWrite"),
        otherSpeak: otherSpeak.value,
        otherWrite: otherWrite.value,
        data: base64Data,
        filename: resumeFile.name,
        mimeType: resumeFile.type
      };

      try {
        const response = await fetch("https://script.google.com/macros/s/AKfycbwu8jCNVXiovyYb3vOWGcX7LoR2yx6VuggwVlth7yXyzFs3RN--WGU0ekr4X5zmNXprgg/exec", {
          method: "POST",
          body: JSON.stringify(data)
        });

        const result = await response.text(); // ✅ Needed!

        if (result.includes("Success")) {
          status.textContent = "";
          status.style.color = "green";

          // ✅ Show success banner
          document.getElementById("successBanner").classList.remove("d-none");
          document.getElementById("successBanner").scrollIntoView({ behavior: "smooth" });

          // ✅ Reset everything
          form.reset();
          [marriageYearGroup, otherEducationGroup, experienceTableContainer, otherSpeakGroup, otherWriteGroup]
            .forEach(el => el.classList.add("hidden"));

          ageField.value = "";
          experienceTbody.innerHTML = `
            <tr>
              <td><input type="text" class="form-control" name="designation[]"></td>
              <td><input type="text" class="form-control" name="responsibilities[]"></td>
              <td><input type="number" class="form-control yearInput" name="years[]"></td>
              <td></td>
            </tr>
          `;
          totalExperience.value = "";
          document.getElementById("appliedDate").value = new Date().toISOString().split("T")[0];

          setTimeout(() => {
            document.getElementById("successBanner").classList.add("d-none");
          }, 4000);
        } else {
          status.textContent = "❌ Upload failed: " + result;
          status.style.color = "red";
        }
      } catch (error) {
        status.textContent = "❌ Network error: " + error.message;
        status.style.color = "red";
      }
    };

    reader.readAsDataURL(resumeFile);
  });
</script>



</body>

</html>